--------------------------------------------------------------------------------
      name:  master
       log:  C:\Users\aet816\Desktop\Research\code\logs/master_2025-09-08.log
  log type:  text
 opened on:   8 Sep 2025, 18:36:48

. 
. * ---------------- 3) Utilities ----------------------------------------
. do "`codedir'00_utils.do"

. *******************************************************
. * 00_utils.do — Utility programs (e.g., _coerce_num)
. *******************************************************
. version 17

. 
. * Coerce variables to numeric when they arrive as strings.
. * - Handles "yes/no", "oui/non", "0/1/2" numeric strings, commas
. cap program drop _coerce_num

. program define _coerce_num
  1.     syntax varlist
  2.     foreach v of local varlist {
  3.         capture confirm numeric variable `v'
  4.         if _rc {
  5.             * Attempt to destring first (ignore commas/spaces)
.             capture destring `v', replace ignore(", ")
  6.             if _rc {
  7.                 * If still not numeric, map common text to numbers
.                 gen double __tmp_num = .
  8.                 replace __tmp_num = 1 if lower(trim(`v'))=="yes" | lower(tr
> im(`v'))=="oui" | trim(`v')=="1"
  9.                 replace __tmp_num = 0 if lower(trim(`v'))=="no"  | lower(tr
> im(`v'))=="non" | trim(`v')=="0"
 10.                 replace __tmp_num = real(`v') if missing(__tmp_num) & regex
> m(`v',"^-?[0-9.]+$")
 11.                 drop `v'
 12.                 rename __tmp_num `v'
 13.             }
 14.         }
 15.     }
 16. end

. 
end of do-file

. 
. * ---------------- 4) Cleaning (read-only on input; writes a copy) ------
. capture noisily do "`codedir'02_clean_bf.do"

. *******************************************************
. * 02_clean_bf.do — Prepare cleaned analytic copy (read-only input)
. *******************************************************
. version 17

. 
. * Load input into memory (we will NOT overwrite it on disk)
. use "$IN_ANALYTIC", clear
file data/clean/Complete_BF_Household_Analysis.dta not found
r(601);

end of do-file

. local rc = _rc

. if `rc' != 0 {
.     di as error "ERROR in 02_clean_bf.do (code = " %9.0g `rc' ")"
ERROR in 02_clean_bf.do (code =       601)
.     log close master
      name:  master
       log:  C:\Users\aet816\Desktop\Research\code\logs/master_2025-09-08.log
  log type:  text
 closed on:   8 Sep 2025, 18:36:48
--------------------------------------------------------------------------------
